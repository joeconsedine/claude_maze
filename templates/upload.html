<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Upload - Presentation Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #242424;
            color: white;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff7c43, #ffa600, #f95d6a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 60px 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #ffa600;
            background: rgba(255, 166, 0, 0.1);
        }

        .upload-area.dragover {
            border-color: #f95d6a;
            background: rgba(249, 93, 106, 0.1);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.6;
        }

        input[type="file"] {
            display: none;
        }

        .file-input-label {
            display: inline-block;
            background: linear-gradient(45deg, #a05195, #d45087);
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(212, 80, 135, 0.4);
        }

        .chart-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-type-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chart-type-card:hover {
            border-color: #ffa600;
            transform: translateY(-4px);
        }

        .chart-type-card.selected {
            border-color: #f95d6a;
            background: rgba(249, 93, 106, 0.2);
        }

        .chart-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            opacity: 0.8;
        }

        .chart-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .chart-description {
            font-size: 0.9rem;
            opacity: 0.7;
            line-height: 1.4;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-label {
            display: block;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .form-input {
            width: 100%;
            padding: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            resize: vertical;
        }

        .form-input:focus {
            outline: none;
            border-color: #ffa600;
            background: rgba(255, 255, 255, 0.15);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff7c43, #ffa600);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 166, 0, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .slides-list {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .slide-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .slide-info h3 {
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        .slide-info p {
            opacity: 0.7;
            font-size: 0.9rem;
        }

        .slide-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Presentation Builder</h1>
            <p>Upload your data and create beautiful, interactive chart presentations</p>
        </div>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìÅ</div>
                <h3>Drag & Drop your data file here</h3>
                <p style="margin: 16px 0; opacity: 0.7;">Supports CSV, JSON, and Excel files</p>
                <label for="fileInput" class="file-input-label">
                    Choose File
                </label>
                <input type="file" id="fileInput" accept=".csv,.json,.xlsx,.xls">
            </div>

            <div class="form-group">
                <label class="form-label">Chart Type</label>
                <div class="chart-type-grid">
                    <div class="chart-type-card" data-type="line">
                        <div class="chart-icon">üìà</div>
                        <div class="chart-name">Line Chart</div>
                        <div class="chart-description">Show trends over time</div>
                    </div>
                    <div class="chart-type-card" data-type="bar">
                        <div class="chart-icon">üìä</div>
                        <div class="chart-name">Bar Chart</div>
                        <div class="chart-description">Compare categories</div>
                    </div>
                    <div class="chart-type-card" data-type="pie">
                        <div class="chart-icon">üç∞</div>
                        <div class="chart-name">Pie Chart</div>
                        <div class="chart-description">Show proportions</div>
                    </div>
                    <div class="chart-type-card" data-type="scatter">
                        <div class="chart-icon">‚ö´</div>
                        <div class="chart-name">Scatter Plot</div>
                        <div class="chart-description">Show correlations</div>
                    </div>
                    <div class="chart-type-card" data-type="radar">
                        <div class="chart-icon">üï∏Ô∏è</div>
                        <div class="chart-name">Radar Chart</div>
                        <div class="chart-description">Multi-dimensional data</div>
                    </div>
                    <div class="chart-type-card" data-type="heatmap">
                        <div class="chart-icon">üî•</div>
                        <div class="chart-name">Heatmap</div>
                        <div class="chart-description">Show intensity patterns</div>
                    </div>
                    <div class="chart-type-card" data-type="treemap">
                        <div class="chart-icon">üå≥</div>
                        <div class="chart-name">Treemap</div>
                        <div class="chart-description">Hierarchical data</div>
                    </div>
                    <div class="chart-type-card" data-type="gauge">
                        <div class="chart-icon">‚è±Ô∏è</div>
                        <div class="chart-name">Gauge</div>
                        <div class="chart-description">Progress indicators</div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="slideTitle" class="form-label">Slide Title</label>
                <input type="text" id="slideTitle" class="form-input" placeholder="Enter a descriptive title for this slide">
            </div>

            <div class="form-group">
                <label for="slideSummary" class="form-label">Slide Summary</label>
                <textarea id="slideSummary" class="form-input" rows="4" placeholder="Provide a brief summary or key insights about this data visualization"></textarea>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="uploadBtn">Create Slide</button>
                <button class="btn btn-secondary" id="previewBtn">Preview</button>
            </div>
        </div>

        <div class="slides-list">
            <h2 style="margin-bottom: 30px;">üìã Current Slides</h2>
            <div id="slidesList">
                <div class="slide-item">
                    <div class="slide-info">
                        <h3>Sample Line Chart</h3>
                        <p>Monthly revenue trends showing growth patterns</p>
                    </div>
                    <div class="slide-actions">
                        <button class="btn btn-small btn-secondary">Edit</button>
                        <button class="btn btn-small btn-primary">View</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chart type selection
        document.querySelectorAll('.chart-type-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.chart-type-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
            });
        });

        // File upload handling
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            console.log('File selected:', file.name);
            document.querySelector('.upload-icon').textContent = '‚úÖ';
            document.querySelector('.upload-area h3').textContent = `File selected: ${file.name}`;
        }

        // Upload button handler
        document.getElementById('uploadBtn').addEventListener('click', async () => {
            const selectedChart = document.querySelector('.chart-type-card.selected');
            const title = document.getElementById('slideTitle').value;
            const summary = document.getElementById('slideSummary').value;
            const fileInput = document.getElementById('fileInput');

            if (!fileInput.files[0]) {
                alert('Please select a file to upload');
                return;
            }

            if (!selectedChart) {
                alert('Please select a chart type');
                return;
            }

            if (!title.trim()) {
                alert('Please enter a slide title');
                return;
            }

            // Show loading state
            const btn = document.getElementById('uploadBtn');
            const originalText = btn.textContent;
            btn.textContent = 'Creating Slide...';
            btn.disabled = true;

            try {
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);
                formData.append('chart_type', selectedChart.dataset.type);
                formData.append('title', title.trim());
                formData.append('summary', summary.trim());

                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    alert('Slide created successfully!');
                    // Reset form
                    document.getElementById('slideTitle').value = '';
                    document.getElementById('slideSummary').value = '';
                    fileInput.value = '';
                    document.querySelectorAll('.chart-type-card').forEach(c => c.classList.remove('selected'));
                    document.querySelector('.upload-icon').textContent = 'üìÅ';
                    document.querySelector('.upload-area h3').textContent = 'Drag & Drop your data file here';

                    // Refresh slides list
                    loadSlidesList();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Upload error:', error);
                alert('Error uploading file. Please try again.');
            } finally {
                btn.textContent = originalText;
                btn.disabled = false;
            }
        });

        // Load slides list
        async function loadSlidesList() {
            try {
                const response = await fetch('/api/slides');
                const slides = await response.json();

                const slidesList = document.getElementById('slidesList');
                slidesList.innerHTML = slides.map(slide => `
                    <div class="slide-item">
                        <div class="slide-info">
                            <h3>${slide.title}</h3>
                            <p>${slide.summary || 'No summary provided'}</p>
                            <small style="opacity: 0.6;">Type: ${slide.chart_type} ${slide.custom ? '(Custom)' : '(Default)'}</small>
                        </div>
                        <div class="slide-actions">
                            <button class="btn btn-small btn-secondary" onclick="editSlide('${slide.id}')">Edit</button>
                            <button class="btn btn-small btn-primary" onclick="viewSlide('${slide.id}')">View</button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading slides:', error);
            }
        }

        function editSlide(slideId) {
            // TODO: Implement edit functionality
            alert('Edit functionality coming soon!');
        }

        function viewSlide(slideId) {
            window.open('/', '_blank');
        }

        // Load slides on page load
        loadSlidesList();
    </script>
</body>
</html>